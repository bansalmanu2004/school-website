<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MDM Monthly Report Calculator</title>
    <style>
        * { font-family: "Poppins", sans-serif; margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #f4f4f4; text-align: center; }
        .container { max-width: 600px; margin: 20px auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.2); }
        input, select { width: 100%; padding: 8px; margin: 5px 0; border: 1px solid #ccc; border-radius: 5px; }
        button { background: #003366; color: #fff; border: none; padding: 10px; margin-top: 10px; cursor: pointer; width: 100%; border-radius: 5px; }
        button:hover { background: #002244; }
        .section-title { font-weight: bold; margin-top: 20px; color: #003366; }
    </style>
</head>
<body>

    <div class="container">
        <h2>MDM Monthly Report Calculator</h2>

        <!-- Part 1: General Details -->
        <p class="section-title">General Details</p>
        <select id="year">
            <script> for(let i = 2025; i <= 2030; i++) document.write(`<option value="${i}">${i}</option>`); </script>
        </select>
        <select id="month">
            <script> ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'].forEach(m => document.write(`<option value="${m}">${m}</option>`)); </script>
        </select>
        <select id="mdmType">
            <option value="Pre-Primary MDM Report">Pre-Primary MDM Report</option>
            <option value="Primary MDM Report">Primary MDM Report</option>
        </select>
        <input type="text" id="currentDate" readonly>
        <script> document.getElementById("currentDate").value = new Date().toLocaleString(); </script>
        <input type="text" id="schoolName" placeholder="Enter School Name">
        <input type="text" id="schoolCode" placeholder="Enter School UDISE Code">
        <input type="number" id="rateCookingCost" placeholder="Price per Student (â‚¹)">
        <input type="number" id="totalStudents" placeholder="Total Students">
        <input type="number" id="daysWheat" placeholder="Number of Days Wheat Served">
        <input type="number" id="daysRice" placeholder="Number of Days Rice Served">
        <input type="text" id="totalDaysMDM" readonly placeholder="Total Days MDM Served">
        
        <!-- Part 2: Student Details & Grains -->
        <p class="section-title">Student & Grains Details</p>
        <input type="number" id="studentsWheat" placeholder="Students Served Wheat">
        <input type="number" id="studentsRice" placeholder="Students Served Rice">
        <input type="text" id="totalBenefited" readonly placeholder="Total Students Benefited">
        <input type="number" id="openingWheat" placeholder="Opening Balance of Wheat">
        <input type="number" id="newWheatStock" placeholder="New Stock of Wheat">
        <input type="text" id="wheatConsumed" readonly placeholder="Wheat Consumed">
        <input type="text" id="closingWheat" readonly placeholder="Closing Balance of Wheat">
        <input type="number" id="openingRice" placeholder="Opening Balance of Rice">
        <input type="number" id="newRiceStock" placeholder="New Stock of Rice">
        <input type="text" id="riceConsumed" readonly placeholder="Rice Consumed">
        <input type="text" id="closingRice" readonly placeholder="Closing Balance of Rice">

        <!-- Part 3: Financial Details -->
        <p class="section-title">Cooking Cost & Fruit Details</p>
        <input type="number" id="openingCookingCost" placeholder="Opening Balance of Cooking Cost">
        <input type="number" id="cookingCostReceived" placeholder="Cooking Cost Received">
        <input type="text" id="cookingCostSpent" readonly placeholder="Cooking Cost Spent">
        <input type="text" id="closingCookingCost" readonly placeholder="Closing Balance of Cooking Cost">
        <input type="number" id="openingFruit" placeholder="Opening Balance of Fruit">
        <input type="number" id="fruitReceived" placeholder="Fruit Amount Received">
        <input type="number" id="studentsGivenFruit" placeholder="Students Given Fruit">
        <input type="text" id="fruitSpent" readonly placeholder="Amount Spent on Fruit">
        <input type="text" id="closingFruit" readonly placeholder="Closing Balance of Fruit">

        <!-- Download PDF Button -->
        <button onclick="downloadPDF()">Download Report (PDF)</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        function updateCalculations() {
            let daysWheat = parseFloat(document.getElementById("daysWheat").value) || 0;
            let daysRice = parseFloat(document.getElementById("daysRice").value) || 0;
            document.getElementById("totalDaysMDM").value = daysWheat + daysRice;

            let studentsWheat = parseFloat(document.getElementById("studentsWheat").value) || 0;
            let studentsRice = parseFloat(document.getElementById("studentsRice").value) || 0;
            document.getElementById("totalBenefited").value = studentsWheat + studentsRice;

            document.getElementById("wheatConsumed").value = (studentsWheat * 0.1).toFixed(2);
            document.getElementById("riceConsumed").value = (studentsRice * 0.1).toFixed(2);

            let rate = parseFloat(document.getElementById("rateCookingCost").value) || 0;
            document.getElementById("cookingCostSpent").value = (studentsWheat + studentsRice) * rate;

            let studentsFruit = parseFloat(document.getElementById("studentsGivenFruit").value) || 0;
            document.getElementById("fruitSpent").value = (studentsFruit * 5).toFixed(2);
        }

        document.querySelectorAll("input").forEach(input => {
            input.addEventListener("input", updateCalculations);
        });

        function downloadPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.setFontSize(16);
            doc.text("MDM Monthly Report", 105, 15, null, null, "center");
            doc.setFontSize(12);
            let y = 30;
            function addField(label, id) {
                let value = document.getElementById(id).value || "";
                doc.text(`${label}: ${value}`, 20, y);
                y += 8;
            }
            ["year", "month", "mdmType", "currentDate", "schoolName", "schoolCode", "rateCookingCost", "totalStudents", "totalDaysMDM", "totalBenefited", "wheatConsumed", "riceConsumed", "cookingCostSpent", "fruitSpent"].forEach(field => addField(field.replace(/([A-Z])/g, ' $1'), field));
            doc.save("MDM_Monthly_Report.pdf");
        }
    </script>

</body>
</html>
